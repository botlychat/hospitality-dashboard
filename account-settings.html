<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Account Settings - Riyadh Getaways</title>
	<base href="/hospitality-dashboard/">
	<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3E🏨%3C/text%3E%3C/svg%3E">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
	<link rel="stylesheet" href="css/variables.css">
	<link rel="stylesheet" href="css/global.css">
	<link rel="stylesheet" href="css/responsive.css">
	<style>
		.account-settings-container {
			max-width: 800px;
			margin: 0 auto;
		}

		.settings-header {
			margin-bottom: 32px;
		}

		.settings-header h1 {
			font-size: 28px;
			font-weight: 700;
			color: var(--text-primary);
			margin: 0 0 8px 0;
		}

		.settings-header p {
			color: var(--muted);
			font-size: 14px;
			margin: 0;
		}

		.settings-section {
			background: white;
			border-radius: 12px;
			padding: 24px;
			margin-bottom: 24px;
			box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
		}

		.settings-section h2 {
			font-size: 18px;
			font-weight: 600;
			margin: 0 0 20px 0;
			color: var(--text-primary);
		}

		.setting-item {
			display: flex;
			justify-content: space-between;
			align-items: center;
			padding: 16px 0;
			border-bottom: 1px solid #e5e7eb;
		}

		.setting-item:last-child {
			border-bottom: none;
		}

		.setting-info {
			flex: 1;
		}

		.setting-label {
			font-size: 14px;
			font-weight: 600;
			color: var(--text-primary);
			margin-bottom: 4px;
		}

		.setting-value {
			font-size: 14px;
			color: var(--muted);
		}

		.setting-value.readonly {
			color: var(--text-primary);
		}

		.edit-btn {
			padding: 8px 16px;
			background: white;
			border: 1px solid #e5e7eb;
			border-radius: 6px;
			color: var(--accent);
			font-size: 13px;
			font-weight: 600;
			cursor: pointer;
			transition: all 0.2s ease;
			display: flex;
			align-items: center;
			gap: 6px;
		}

		.edit-btn:hover {
			background: #f9fafb;
			border-color: var(--accent);
		}

		.save-btn {
			padding: 10px 24px;
			background: var(--accent);
			border: none;
			border-radius: 8px;
			color: white;
			font-size: 14px;
			font-weight: 600;
			cursor: pointer;
			transition: all 0.2s ease;
			margin-top: 16px;
		}

		.save-btn:hover {
			opacity: 0.9;
		}

		/* Modal Styles */
		.modal-overlay {
			display: none;
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(0, 0, 0, 0.5);
			z-index: 1000;
			align-items: center;
			justify-content: center;
		}

		.modal-overlay.active {
			display: flex;
		}

		.modal-content {
			background: white;
			border-radius: 12px;
			padding: 24px;
			max-width: 480px;
			width: 90%;
			max-height: 90vh;
			overflow-y: auto;
		}

		.modal-header {
			margin-bottom: 20px;
		}

		.modal-header h3 {
			font-size: 20px;
			font-weight: 700;
			margin: 0 0 8px 0;
		}

		.modal-header p {
			font-size: 14px;
			color: var(--muted);
			margin: 0;
		}

		.form-group {
			margin-bottom: 16px;
		}

		.form-group label {
			display: block;
			font-size: 14px;
			font-weight: 600;
			margin-bottom: 8px;
			color: var(--text-primary);
		}

		.form-group input {
			width: 100%;
			padding: 10px 12px;
			border: 1px solid #e5e7eb;
			border-radius: 8px;
			font-size: 14px;
			transition: border-color 0.2s ease;
			box-sizing: border-box;
		}

		.form-group input:focus {
			outline: none;
			border-color: var(--accent);
		}

		.modal-actions {
			display: flex;
			gap: 12px;
			justify-content: flex-end;
			margin-top: 24px;
		}

		.modal-btn {
			padding: 10px 20px;
			border-radius: 8px;
			font-size: 14px;
			font-weight: 600;
			cursor: pointer;
			transition: all 0.2s ease;
		}

		.modal-btn-cancel {
			background: white;
			border: 1px solid #e5e7eb;
			color: var(--text-primary);
		}

		.modal-btn-cancel:hover {
			background: #f9fafb;
		}

		.modal-btn-confirm {
			background: var(--accent);
			border: none;
			color: white;
		}

		.modal-btn-confirm:hover {
			opacity: 0.9;
		}

		.error-message {
			color: #ef4444;
			font-size: 13px;
			margin-top: 4px;
		}

		.success-message {
			background: #10b981;
			color: white;
			padding: 12px 16px;
			border-radius: 8px;
			margin-bottom: 16px;
			display: none;
		}

		.success-message.show {
			display: block;
		}
	</style>

	<!-- Service Worker Registration -->
	<script>
		if ('serviceWorker' in navigator) {
			window.addEventListener('load', () => {
				navigator.serviceWorker.register('service-worker.js')
					.then(reg => console.log('✓ Service Worker registered'))
					.catch(err => console.log('✗ Service Worker registration failed:', err));
			});
		}
	</script>
</head>
<body>
	<!-- HEADER AND SIDEBAR WILL BE INJECTED BY BUILD SCRIPT -->

	<div class="account-settings-container">
		<div class="settings-header">
			<h1 data-i18n="accountSettings">Account Settings</h1>
			<p data-i18n="accountSettingsDesc">Manage your business information and account credentials</p>
		</div>

		<div id="successMessage" class="success-message"></div>

		<!-- Business Information Section -->
		<div class="settings-section">
			<h2 data-i18n="businessInformation">Business Information</h2>
			
			<div class="setting-item">
				<div class="setting-info">
					<div class="setting-label" data-i18n="businessName">Business Name</div>
					<div class="setting-value readonly" id="businessNameValue">Riyadh Getaways</div>
				</div>
				<button class="edit-btn" onclick="editBusinessName()">
					<i class="fa-solid fa-pen"></i>
					<span data-i18n="edit">Edit</span>
				</button>
			</div>

			<div class="setting-item">
				<div class="setting-info">
					<div class="setting-label" data-i18n="phoneNumber">Phone Number</div>
					<div class="setting-value readonly" id="phoneNumberValue">+966 50 123 4567</div>
				</div>
				<button class="edit-btn" onclick="editPhoneNumber()">
					<i class="fa-solid fa-pen"></i>
					<span data-i18n="edit">Edit</span>
				</button>
			</div>
		</div>

		<!-- Account Security Section -->
		<div class="settings-section">
			<h2 data-i18n="accountSecurity">Account Security</h2>
			
			<div class="setting-item">
				<div class="setting-info">
					<div class="setting-label" data-i18n="email">Email</div>
					<div class="setting-value readonly" id="emailValue">admin@riyadhgetaways.com</div>
				</div>
				<button class="edit-btn" onclick="editEmail()">
					<i class="fa-solid fa-pen"></i>
					<span data-i18n="edit">Edit</span>
				</button>
			</div>

			<div class="setting-item">
				<div class="setting-info">
					<div class="setting-label" data-i18n="password">Password</div>
					<div class="setting-value">••••••••</div>
				</div>
				<button class="edit-btn" onclick="editPassword()">
					<i class="fa-solid fa-pen"></i>
					<span data-i18n="edit">Edit</span>
				</button>
			</div>
		</div>
	</div>

	<!-- Edit Business Name Modal -->
	<div class="modal-overlay" id="businessNameModal">
		<div class="modal-content">
			<div class="modal-header">
				<h3 data-i18n="editBusinessName">Edit Business Name</h3>
			</div>
			<div class="form-group">
				<label data-i18n="newBusinessName">New Business Name</label>
				<input type="text" id="newBusinessName" placeholder="Enter new business name">
			</div>
			<div class="modal-actions">
				<button class="modal-btn modal-btn-cancel" onclick="closeModal('businessNameModal')">
					<span data-i18n="cancel">Cancel</span>
				</button>
				<button class="modal-btn modal-btn-confirm" onclick="saveBusinessName()">
					<span data-i18n="save">Save</span>
				</button>
			</div>
		</div>
	</div>

	<!-- Edit Phone Number Modal -->
	<div class="modal-overlay" id="phoneNumberModal">
		<div class="modal-content">
			<div class="modal-header">
				<h3 data-i18n="editPhoneNumber">Edit Phone Number</h3>
			</div>
			<div class="form-group">
				<label data-i18n="newPhoneNumber">New Phone Number</label>
				<input type="tel" id="newPhoneNumber" placeholder="+966 50 123 4567">
			</div>
			<div class="modal-actions">
				<button class="modal-btn modal-btn-cancel" onclick="closeModal('phoneNumberModal')">
					<span data-i18n="cancel">Cancel</span>
				</button>
				<button class="modal-btn modal-btn-confirm" onclick="savePhoneNumber()">
					<span data-i18n="save">Save</span>
				</button>
			</div>
		</div>
	</div>

	<!-- Edit Email Modal -->
	<div class="modal-overlay" id="emailModal">
		<div class="modal-content">
			<div class="modal-header">
				<h3 data-i18n="editEmail">Edit Email</h3>
				<p data-i18n="editEmailDesc">You must provide your current email to change it</p>
			</div>
			<div class="form-group">
				<label data-i18n="currentEmail">Current Email</label>
				<input type="email" id="currentEmail" placeholder="Enter current email">
				<div id="currentEmailError" class="error-message"></div>
			</div>
			<div class="form-group">
				<label data-i18n="newEmail">New Email</label>
				<input type="email" id="newEmail" placeholder="Enter new email">
			</div>
			<div class="form-group">
				<label data-i18n="confirmNewEmail">Confirm New Email</label>
				<input type="email" id="confirmNewEmail" placeholder="Confirm new email">
				<div id="confirmEmailError" class="error-message"></div>
			</div>
			<div class="modal-actions">
				<button class="modal-btn modal-btn-cancel" onclick="closeModal('emailModal')">
					<span data-i18n="cancel">Cancel</span>
				</button>
				<button class="modal-btn modal-btn-confirm" onclick="saveEmail()">
					<span data-i18n="save">Save</span>
				</button>
			</div>
		</div>
	</div>

	<!-- Edit Password Modal -->
	<div class="modal-overlay" id="passwordModal">
		<div class="modal-content">
			<div class="modal-header">
				<h3 data-i18n="editPassword">Edit Password</h3>
				<p data-i18n="editPasswordDesc">You must provide your current password to change it</p>
			</div>
			<div class="form-group">
				<label data-i18n="currentPassword">Current Password</label>
				<input type="password" id="currentPassword" placeholder="Enter current password">
				<div id="currentPasswordError" class="error-message"></div>
			</div>
			<div class="form-group">
				<label data-i18n="newPassword">New Password</label>
				<input type="password" id="newPassword" placeholder="Enter new password (min 8 characters)">
			</div>
			<div class="form-group">
				<label data-i18n="confirmNewPassword">Confirm New Password</label>
				<input type="password" id="confirmNewPassword" placeholder="Confirm new password">
				<div id="confirmPasswordError" class="error-message"></div>
			</div>
			<div class="modal-actions">
				<button class="modal-btn modal-btn-cancel" onclick="closeModal('passwordModal')">
					<span data-i18n="cancel">Cancel</span>
				</button>
				<button class="modal-btn modal-btn-confirm" onclick="savePassword()">
					<span data-i18n="save">Save</span>
				</button>
			</div>
		</div>
	</div>

	<script src="js/storage.js"></script>
	<script src="js/utils.js"></script>

	<script>
		// Initialize account settings
		let accountSettings = Storage.getJSON('accountSettings', {
			businessName: 'Riyadh Getaways',
			phoneNumber: '+966 50 123 4567',
			email: 'admin@riyadhgetaways.com',
			password: 'admin123' // In production, this should be hashed
		});

		// Load current values
		function loadAccountSettings() {
			document.getElementById('businessNameValue').textContent = accountSettings.businessName;
			document.getElementById('phoneNumberValue').textContent = accountSettings.phoneNumber;
			document.getElementById('emailValue').textContent = accountSettings.email;
		}

		// Edit Business Name
		function editBusinessName() {
			document.getElementById('newBusinessName').value = accountSettings.businessName;
			openModal('businessNameModal');
		}

		function saveBusinessName() {
			const newName = document.getElementById('newBusinessName').value.trim();
			if (newName) {
				accountSettings.businessName = newName;
				Storage.setJSON('accountSettings', accountSettings);
				loadAccountSettings();
				closeModal('businessNameModal');
				showSuccess('Business name updated successfully');
			}
		}

		// Edit Phone Number
		function editPhoneNumber() {
			document.getElementById('newPhoneNumber').value = accountSettings.phoneNumber;
			openModal('phoneNumberModal');
		}

		function savePhoneNumber() {
			const newPhone = document.getElementById('newPhoneNumber').value.trim();
			if (newPhone) {
				accountSettings.phoneNumber = newPhone;
				Storage.setJSON('accountSettings', accountSettings);
				loadAccountSettings();
				closeModal('phoneNumberModal');
				showSuccess('Phone number updated successfully');
			}
		}

		// Edit Email
		function editEmail() {
			document.getElementById('currentEmail').value = '';
			document.getElementById('newEmail').value = '';
			document.getElementById('confirmNewEmail').value = '';
			document.getElementById('currentEmailError').textContent = '';
			document.getElementById('confirmEmailError').textContent = '';
			openModal('emailModal');
		}

		function saveEmail() {
			const currentEmail = document.getElementById('currentEmail').value.trim();
			const newEmail = document.getElementById('newEmail').value.trim();
			const confirmEmail = document.getElementById('confirmNewEmail').value.trim();
			
			// Clear previous errors
			document.getElementById('currentEmailError').textContent = '';
			document.getElementById('confirmEmailError').textContent = '';

			// Validate current email
			if (currentEmail !== accountSettings.email) {
				document.getElementById('currentEmailError').textContent = 'Current email is incorrect';
				return;
			}

			// Validate new email format
			const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
			if (!emailRegex.test(newEmail)) {
				document.getElementById('confirmEmailError').textContent = 'Invalid email format';
				return;
			}

			// Validate confirmation
			if (newEmail !== confirmEmail) {
				document.getElementById('confirmEmailError').textContent = 'Email addresses do not match';
				return;
			}

			// Update email
			accountSettings.email = newEmail;
			Storage.setJSON('accountSettings', accountSettings);
			loadAccountSettings();
			closeModal('emailModal');
			showSuccess('Email updated successfully');
		}

		// Edit Password
		function editPassword() {
			document.getElementById('currentPassword').value = '';
			document.getElementById('newPassword').value = '';
			document.getElementById('confirmNewPassword').value = '';
			document.getElementById('currentPasswordError').textContent = '';
			document.getElementById('confirmPasswordError').textContent = '';
			openModal('passwordModal');
		}

		function savePassword() {
			const currentPassword = document.getElementById('currentPassword').value;
			const newPassword = document.getElementById('newPassword').value;
			const confirmPassword = document.getElementById('confirmNewPassword').value;
			
			// Clear previous errors
			document.getElementById('currentPasswordError').textContent = '';
			document.getElementById('confirmPasswordError').textContent = '';

			// Validate current password
			if (currentPassword !== accountSettings.password) {
				document.getElementById('currentPasswordError').textContent = 'Current password is incorrect';
				return;
			}

			// Validate new password length
			if (newPassword.length < 8) {
				document.getElementById('confirmPasswordError').textContent = 'Password must be at least 8 characters';
				return;
			}

			// Validate confirmation
			if (newPassword !== confirmPassword) {
				document.getElementById('confirmPasswordError').textContent = 'Passwords do not match';
				return;
			}

			// Update password
			accountSettings.password = newPassword;
			Storage.setJSON('accountSettings', accountSettings);
			closeModal('passwordModal');
			showSuccess('Password updated successfully');
		}

		// Modal helpers
		function openModal(modalId) {
			document.getElementById(modalId).classList.add('active');
		}

		function closeModal(modalId) {
			document.getElementById(modalId).classList.remove('active');
		}

		// Close modal on background click
		document.querySelectorAll('.modal-overlay').forEach(modal => {
			modal.addEventListener('click', (e) => {
				if (e.target === modal) {
					modal.classList.remove('active');
				}
			});
		});

		// Success message
		function showSuccess(message) {
			const successEl = document.getElementById('successMessage');
			successEl.textContent = message;
			successEl.classList.add('show');
			setTimeout(() => {
				successEl.classList.remove('show');
			}, 3000);
		}

		// Load settings on page load
		document.addEventListener('DOMContentLoaded', () => {
			loadAccountSettings();
		});
	</script>
</body>
</html>
